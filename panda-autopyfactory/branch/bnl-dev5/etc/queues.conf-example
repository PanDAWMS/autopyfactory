#
# queues.conf  Configuration file for WMSQueue component of AutoPyFactory.
#

## Defaults for queues - these values are set when there is not an explicit value
## If you don't set them here the factory takes sensible default values, so nothing is mandatory
## see ConfigLoader._configurationDefaults() for these values. 
#
# Most important values can now be detected from schedconfig, so there is no need to set them
# at all. These values are marked with a *. N.B. Even if you do set these values in the factory
# they will be overwritten unless the "override = True" setting is used.
#
# Some of these values may be in the process of deprecation, especially submission parameters 
# which are now handled by the submit plugins. 

# ================================================== 
#               VARIABLES
# ================================================== 

# cloud
# jdl
# nickname
# siteid
# proxy
#
# cleanlogs.maxdays
#
# schedplugin
# sched.activated.default
# sched.activated.max_jobs_torun
# sched.activated.max_pilots_per_cycle
# sched.activated.min_pilots_per_cycle
# sched.activated.max_pilots_pending
# sched.fixed.pilotspercycle
# sched.simple.default
# sched.simple.maxpendingpilots
# sched.simple.maxpilotspercycle
# sched.simplenqueue.default
# sched.simplenqueue.maxpilotspercycle
# sched.simplenqueue.nqueue
# sched.trivial.default
#
# wmsstatusplugin
# wmsqueue.sleep
#
# batchstatusplugin
#
# batchsubmitplugin
# batchsubmit.condorgt2.condor_attributes
# batchsubmit.condorgt2.environ
# batchsubmit.condorgt2.localqueue
# batchsubmit.condorlocal.condor_attributes
# batchsubmit.condorlocal.environ
#
# executable
# executable.arguments
# executable.pandagrid
# executable.pandaloglevel
# executable.pandaserverurl
# executable.pandawrappertarballurl

# ================================================== 


[DEFAULT]
# Status can be test, offline, or online 
#status = test

#nqueue = 10
#depthboost = 2
#idlepilotsupression = 1

#   wallClock and *memory are in minutes and MB - 'None' means nothing is added to JDL
#   Any setting for memory is now used as a flag to the pilot wrapper which will set this 
#   as a ulimit before starting the pilot.
# wallClock = None
# memory = None
# jobRecovery = False

# pilotlimit sets a hard limit on the total number of pilots at a site, active + queued
# pilotlimit = None

#  *transferringlimit sets a limit on the number of jobs in transferring status allowed at a site -
#    when this limit is reached no pilots will be submitted to allow backlogs to clear
#transferringlimit = 3000
#user = None

#  *cloud is the cloud this queue is in. You should set this to suppress pilot submission when the cloud
#   goes offline
#   N.B. Panda clouds are UPPER CASE, e.g., UK
cloud = US
country = US
group = None

## Set the server and port to contact for jobs
## These can be overridden on a per-queue basis
## But in general do not touch these
server = https://pandaserver.cern.ch
port = 25443

# plugins
batchstatusplugin = Condor
wmsstatusplugin = Panda
batchsubmitplugin = CondorGT2
schedplugin = Trivial

# number of pilots to be submitted when the info
# collected from the batch system and/or the WMS system
# is not reliable 
sched.trivial.default = 0
sched.simple.default = 0
sched.simplenqueue.default = 0
sched.activated.default = 0

# New proxy configuration. Uses internal proxymanager.
# Entry value should be the name of the proxy handler for the proxy you
# wish to use. See etc/proxy.conf
# proxy = atlas-usatlas
proxy = None

# MOVED FROM FACTORY.CONF
# sleep time between cycles in WMSQueue object
wmsqueue.sleep = 360

# MOVED FROM FACTORY.CONF
# Executable is the script which will be run by condor. This can contain
# the uuencoded pilot tarball (rebuild with mkPilotWraper.py), but it is now
# recommended only to send the script and let it download the latest
# pilot code from CERN (which it will do automatically).
#
# If you are doing pilot development you can set the PILOT_HTTP_SOURCES variable
# to get your pilot code downloaded on any queue.
#
# *** N.B. there is a caching bug in condor_g which means that changes to this
#  script are not picked up by condor. Best to make a soft link from a 
#  fake name back to the original when you modify this script, e.g,
#  "emacs runpilot3-wrapper.sh"
#  "ln -s runpilot3-wrapper.sh runpilot3-wrapper-1.sh"
#  "executable = runpilot3-wrapper-1.sh"
executable = /usr/libexec/wrapper.sh

# URL with the wrapper tar ball
executable.pandawrappertarballurl = http://dev.racf.bnl.gov/dist/wrapper/
# base URL with the VO-specific pilot tarball
executable.pandaserverurl = http://pandaserver.cern.ch:25080/cache/pilot

#  override, if True then schedconfig does not clobber configuration file values.
override = True

# ====================================================================== 
#               Individual queue configurations
# ====================================================================== 

[BNL_ITB_Test1]
siteid = BNL_ITB_Test1
nickname = BNL_ITB_Test1-condor
jdl = gridtest01.racf.bnl.gov/jobmanager-condor
status = test
sftemplate=/path/to/file

executable.pandagrid = OSG
executable.arguments = -j false -k 600 -u panda 

schedplugin = Trivial

batchsubmitplugin = CondorLocal
batchsubmit.condorlocal.localqueue = OSG_ITB_Jose
# list of condor attributes, splited by comma, to be included in the condor submit file *verbatim*
batchsubmit.condorlocal.condor_attributes = +RACF_Group = "osgitb",+Experiment = "ATLAS",+VO = "usatlas",+Job_Type = "cas"
# list of environment variables, splitted by white spaces, to be included in the
# condor attribute environment *verbatim*
batchsubmit.condorlocal.environ = OSG_GRID=/afs/usatlas/osg/wn-client/@sys/itb


# ------------------------------------------------------------------------

[ANALY_BNL_ATLAS_1]
siteid = ANALY_BNL_ATLAS_1
nickname = ANALY_BNL_ATLAS_1-condor
jdl = gridgk05.racf.bnl.gov/jobmanager-condor

executable.pandagrid = OSG
executable.pandaloglevel = debug
executable.arguments = --script=pilot.py --libcode=pilotcode.tar.gz,pilotcode-rc.tar.gz --pilotsrcurl=http://panda.cern.ch:25880/cache -f false -m false --user user

proxy = atlas-production

schedplugin = Activated
sched.activated.min_pilots_per_cycle = 0
sched.activated.max_pilots_per_cycle = 10
sched.activated.max_jobs_torun = 60

batchsubmit.condorgt2.localqueue = short

sleep = 600 ; #10 minutes

